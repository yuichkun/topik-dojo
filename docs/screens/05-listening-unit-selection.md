# リスニングテストユニット選択画面 仕様書

## 画面概要
選択された級に対して、リスニングテストを行うユニットを選択する画面。

## UI参考資料
[元画像](../../docs/original-materials/ユニット選択.png)
※ 学習用ユニット選択画面とほぼ同じレイアウト

## レイアウト構成
- **ヘッダー**: 選択された級+テストモードの表示 + 戻るボタン
- **メインエリア**: ユニット選択ボタン一覧（グリッド表示）

## UI要素詳細

### ヘッダー部分
- **級+モード表示**: 選択された級とリスニングテストを表示
  - 例：「1級 リスニングテスト」
  - 例：「3級 リスニングテスト」
- **戻るボタン**: テストモード選択画面へ戻る
- **配置**: 画面上部

### ユニット選択ボタン
- **表示形式**: 「1-10」「11-20」「21-30」...の形式
- **配置**: グリッド形式で複数列表示
- **スタイル**: 学習用と同じ統一されたボタンデザイン
- **タップ動作**: 選択したユニットのリスニングテスト画面へ遷移
- **遷移先**: `08-listening-test.md`

### ユニットデータの取得
**データベース駆動**: UNITSテーブルから級別ユニット一覧を取得（[03-unit-selection.md](./03-unit-selection.md)と同じ）
- **クエリ**: `SELECT * FROM units WHERE grade = ? ORDER BY unit_number`
- **表示名計算**: `{(unit_number-1)*10+1}-{unit_number*10}`
- **useUnits hook**: データ取得・ローディング・エラー状態管理

各級のユニット数（requirements.mdより）：
- **1級**: 40ユニット
- **2級**: 140ユニット
- **3級**: 200ユニット
- **4級**: 200ユニット
- **5級**: 300ユニット
- **6級**: 300ユニット

## 状態管理

### 画面パラメータ
- **級情報**: ナビゲーションパラメータで管理（例: `grade: 3`）
- **表示**: ヘッダー部分に級+リスニングテスト表示
- **引き継ぎ**: 次のリスニングテスト画面に級+ユニット情報を渡す


## ナビゲーション

### 戻るボタン
- **動作**: テストモード選択画面へ戻る
- **遷移先**: `04-test-mode-selection.md`

### ホームボタン
- **動作**: トップ画面への直接遷移
- **遷移先**: `01-top.md`

## スクロール対応

### 長いリスト表示
- **対応**: 縦スクロール対応（特に高級レベル）
- **実装**: [03-unit-selection.md](./03-unit-selection.md)と同じ実装

## エラーハンドリング

### 不正なパラメータ
- **対応**: デフォルト値を設定（grade: 1）
- **条件**: grade が1-6以外
- **表示**: エラーメッセージは表示せず、デフォルト値で動作

### データ読み込み失敗
- **ローディング状態**: ActivityIndicatorで読み込み中表示
- **エラー状態**: エラーメッセージと戻るボタン表示
- **空データ**: ヘッダーのみ表示（ユニットボタンなし）

## 技術要件

### 必要なデータ
- ナビゲーションパラメータから級情報を取得
- **データベース**: UNITSテーブルからの級別ユニット一覧
- **useUnits hook**: データ取得・ローディング・エラー状態管理

---
*ファイル作成日: 2025/6/13*
*実装担当: AIエージェント*